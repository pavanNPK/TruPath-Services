<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>Jobs Dashboard | TruPath Services</title>

  <meta name="robots" content="noindex, nofollow">

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="../assets/images/core/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="../assets/images/core/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../assets/images/core/favicon-16x16.png">
  <link rel="icon" type="image/svg+xml" href="../assets/images/core/favicon.svg">
  <link rel="apple-touch-icon" sizes="180x180" href="../assets/images/core/apple-touch-icon.png">

  <!-- CSS -->
  <link rel="stylesheet" href="../lib/css/bootstrap.min.css">
  <link rel="stylesheet" href="./admin.css">
  
  <!-- Quill Editor CSS -->
  <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Sen', sans-serif;
      background-color: #F8F8F8;
      overflow-x: hidden;
    }

    .main-container {
      display: flex;
      min-height: 100vh;
    }

    /* Sidebar Styles */
    .sidebar {
      width: 250px;
      background-color: #051C3B;
      color: white;
      padding: 20px 0;
      position: fixed;
      height: 100vh;
      left: 0;
      top: 0;
      z-index: 1000;
    }

    .sidebar-header {
      padding: 0 20px 30px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      margin-bottom: 30px;
    }

    .nav-menu {
      list-style: none;
      padding: 0 20px;
    }

    .nav-item {
      margin-bottom: 10px;
    }

    .nav-link {
      display: flex;
      align-items: baseline;
      gap: 12px;
      padding: 12px 15px;
      color: white;
      text-decoration: none;
      border-radius: 8px;
      transition: all 0.3s ease;
    }

    .nav-link.active {
      background-color: #01142E;
    }

    .nav-link:hover {
      background-color: rgba(255, 255, 255, 0.1);
    }

    .nav-icon {
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .logout-link {
      position: absolute;
      bottom: 20px;
      left: 20px;
      right: 20px;
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 15px;
      color: white;
      text-decoration: none;
      border-radius: 8px;
      transition: all 0.3s ease;
    }

    .logout-link:hover {
      background-color: rgba(255, 255, 255, 0.1);
      color: white;
      text-decoration: none;
    }

    /* Main Content */
    .main-content {
      margin-left: 250px;
      flex: 1;
      padding: 30px 30px 0 30px;
      background-color: #F8F8F8;
      height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .content-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      width: 100%;
    }

    .content-header-left {
      flex: 1;
    }

    .content-header-right {
      display: flex;
      align-items: center;
      justify-content: flex-end;
      gap: 15px;
    }

    .search-container {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .search-input {
      width: 250px;
      padding: 12px 15px;
      border: 1px solid #DDDDDD;
      border-radius: 25px;
      font-size: 14px;
      outline: none;
    }

    .search-input::placeholder {
      color: #AAAAAA;
    }

    .jobs-per-page-select {
      padding: 12px 15px 12px 20px;
      border: 1px solid #DDDDDD;
      border-radius: 25px;
      font-size: 14px;
      outline: none;
      background-color: white;
      color: #333;
      cursor: pointer;
      transition: all 0.3s ease;
      background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");
      background-repeat: no-repeat;
      background-position: right 12px center;
      background-size: 16px;
      padding-right: 40px;
      -webkit-appearance: none;
      -moz-appearance: none;
      appearance: none;
    }

    .jobs-per-page-select:focus {
      border-color: #051C3B;
    }

    .post-job-btn {
      background-color: #051C3B;
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 25px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .post-job-btn:hover {
      background-color: #01142E;
    }

    /* Job Sections */
    .jobs-container {
      display: flex;
      gap: 30px;
      flex: 1;
      min-height: 0;
    }

    .jobs-list {
      flex: 2;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .jobs-content {
      flex: 1;
      overflow-y: auto;
      padding-right: 10px;
    }

    .no-jobs-message {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 300px;
      text-align: center;
    }

    .no-jobs-content h3 {
      color: #666;
      font-size: 1.5rem;
      margin-bottom: 10px;
    }

    .no-jobs-content p {
      color: #999;
      font-size: 1rem;
    }

    .job-details {
      position: fixed;
      top: 0;
      right: -400px;
      width: 400px;
      height: 100vh;
      background: white;
      border-radius: 10px 0 0 10px;
      padding: 25px;
      box-shadow: -5px 0 20px rgba(0, 0, 0, 0.15);
      transition: right 0.3s ease;
      z-index: 1000;
      overflow-y: auto;
    }

    .job-details.show {
      right: 0;
    }

    .section-title {
      font-size: 1.5rem;
      font-weight: 600;
      color: #333;
      margin-bottom: 20px;
    }

    .jobs-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
      padding: 20px 0;
    }

    .job-card {
      background: white;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      position: relative;
      transition: all 0.3s ease;
    }

    .job-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
    }

    .job-card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 15px;
    }

    .job-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: #333;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .job-title-icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 1.2rem;
      color: white;
      margin-right: 12px;
      flex-shrink: 0;
    }

    .job-title-icon.hcc { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    .job-title-icon.ai { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
    .job-title-icon.drg { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
    .job-title-icon.default { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }

    .job-company {
      color: #666;
      font-size: 0.9rem;
      margin-bottom: 8px;
    }

    .job-location {
      color: #666;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      gap: 5px;
      margin-bottom: 10px;
    }

    .job-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 15px;
    }

    .job-date {
      color: #999;
      font-size: 0.8rem;
    }


    .closed-badge {
      background-color: #FCE4EC;
      color: #F44336;
      padding: 4px 12px;
      border-radius: 15px;
      font-size: 0.8rem;
      font-weight: 500;
      margin-left: 8px;
    }

    .job-actions {
      position: absolute;
      top: 15px;
      right: 15px;
      cursor: pointer;
    }

    .dropdown-menu {
      position: absolute;
      top: 25px;
      right: 0;
      background: white;
      border-radius: 8px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
      padding: 8px 0;
      min-width: 120px;
      z-index: 1000;
      display: none;
    }

    .dropdown-item {
      padding: 8px 15px;
      color: #333;
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.9rem;
      transition: background-color 0.2s;
    }

    .dropdown-item:hover {
      background-color: #f8f9fa;
      color: #333;
      text-decoration: none;
    }

    /* Job Details Panel */
    .job-details-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
    }

    .job-details-title {
      margin: 0;
      font-size: 1.3rem;
      font-weight: 600;
      color: #333;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: #333;
    }

    .form-input {
      width: 100%;
      padding: 12px;
      border: 1px solid #DDDDDD;
      border-radius: 6px;
      font-size: 14px;
      outline: none;
      transition: border-color 0.3s;
    }

    .form-input:focus {
      border-color: #051C3B;
    }

    .form-textarea {
      width: 100%;
      padding: 12px;
      border: 1px solid #DDDDDD;
      border-radius: 6px;
      font-size: 14px;
      outline: none;
      resize: vertical;
      min-height: 100px;
      transition: border-color 0.3s;
    }

    .form-textarea:focus {
      border-color: #051C3B;
    }

    .form-select {
      width: 100%;
      padding: 12px;
      border: 1px solid #DDDDDD;
      border-radius: 6px;
      font-size: 14px;
      outline: none;
      background-color: white;
      transition: border-color 0.3s;
    }

    .form-select:focus {
      border-color: #051C3B;
    }

    .quill-editor {
      border: 1px solid #DDDDDD;
      border-radius: 6px;
      min-height: 150px;
    }

    .quill-editor .ql-editor {
      padding: 12px;
    }

    .quill-editor .ql-editor.ql-blank::before {
      font-style: normal;
      color: #AAAAAA;
    }

    .job-description-view {
      border: 1px solid #DDDDDD;
      border-radius: 6px;
      padding: 12px;
      min-height: 150px;
      background-color: #f5f5f5;
      font-size: 14px;
      line-height: 1.5;
    }

    .job-description-view h1,
    .job-description-view h2 {
      margin: 0 0 10px 0;
      font-weight: 600;
    }

    .job-description-view p {
      margin: 0 0 10px 0;
    }

    .job-description-view ul,
    .job-description-view ol {
      margin: 0 0 10px 0;
      padding-left: 20px;
    }

    .job-description-view li {
      margin-bottom: 5px;
    }

    .job-description-view strong {
      font-weight: 600;
    }

    .job-description-view em {
      font-style: italic;
    }

    .job-description-view u {
      text-decoration: underline;
    }

    .quill-editor:focus-within {
      border-color: #051C3B;
    }

    .ql-toolbar {
      border-bottom: 1px solid #DDDDDD;
    }

    .ql-container {
      border: none;
      font-size: 14px;
    }

    .responsibilities-list {
      margin-top: 10px;
      padding-left: 20px;
    }

    .responsibilities-list li {
      margin-bottom: 5px;
      color: #666;
      font-size: 0.9rem;
    }

    .action-buttons {
      display: flex;
      gap: 10px;
      margin-top: 25px;
    }

    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .btn-primary {
      background-color: #051C3B;
      color: white;
    }

    .btn-primary:hover {
      background-color: #01142E;
    }

    .btn-danger {
      background-color: #F44336;
      color: white;
    }

    .btn-danger:hover {
      background-color: #D32F2F;
    }

    .btn-secondary {
      background-color: #6c757d;
      color: white;
    }

    .btn-secondary:hover {
      background-color: #5a6268;
    }

    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 10000;
      backdrop-filter: blur(5px);
    }

    .modal-content {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      border-radius: 10px;
      padding: 30px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      text-align: center;
      min-width: 300px;
    }

    .modal-title {
      font-size: 1.2rem;
      font-weight: 600;
      color: #333;
      margin-bottom: 20px;
    }

    .modal-actions {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-top: 25px;
    }

    /* Loading and Toast Styles */
    .loading-spinner {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 9999;
    }

    .spinner {
      width: 50px;
      height: 50px;
      border: 5px solid rgba(255, 255, 255, 0.3);
      border-top: 5px solid #051C3B;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .toast-container {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 10000;
    }

    .toast {
      background: rgba(0, 0, 0, 0.9);
      color: white;
      padding: 15px 20px;
      border-radius: 10px;
      margin-bottom: 10px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      transform: translateX(400px);
      transition: transform 0.3s ease;
    }

    .toast.show {
      transform: translateX(0);
    }

    .toast.success {
      border-left: 4px solid #4ecdc4;
    }

    .toast.error {
      border-left: 4px solid #ff6b6b;
    }

    /* Pagination Styles */
    .pagination-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 15px;
      border-top: 1px solid #DDDDDD;
      background: white;
      flex-shrink: 0;
    }

    .pagination-info {
      color: #666;
      font-size: 14px;
    }

    .pagination-controls {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .pagination-btn {
      padding: 8px 16px;
      border: 1px solid #DDDDDD;
      background: white;
      color: #333;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .pagination-btn:hover:not(:disabled) {
      background-color: #051C3B;
      color: white;
      border-color: #051C3B;
    }

    .pagination-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .pagination-pages {
      display: flex;
      gap: 5px;
    }

    .page-number {
      padding: 8px 12px;
      border: 1px solid #DDDDDD;
      background: white;
      color: #333;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.3s ease;
      min-width: 40px;
      text-align: center;
    }

    .page-number:hover {
      background-color: #f8f9fa;
    }

    .page-number.active {
      background-color: #051C3B;
      color: white;
      border-color: #051C3B;
    }

    .page-number:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    /* Responsive Design */
    @media (max-width: 1200px) {
      .jobs-grid {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .job-details {
        width: 350px;
        right: -350px;
      }
      
      .search-input {
        width: 200px;
      }
    }

    @media (max-width: 768px) {
      .sidebar {
        transform: translateX(-100%);
        transition: transform 0.3s ease;
      }
      
      .sidebar.open {
        transform: translateX(0);
      }
      
      .main-content {
        margin-left: 0;
        padding: 20px;
      }
      
      .content-header {
        flex-direction: column;
        gap: 20px;
        align-items: center;
        text-align: center;
      }
      
      .content-header-left {
        order: 1;
        width: 100%;
      }
      
      .content-header-right {
        order: 2;
        width: 100%;
        justify-content: center;
      }
      
      .search-container {
        flex-direction: column;
        gap: 15px;
        width: 100%;
        max-width: 400px;
      }
      
      .search-input {
        width: 100%;
      }

      .jobs-per-page-select {
        width: 100%;
      }
      
      .post-job-btn {
        width: 100%;
        justify-content: center;
      }
      
      .jobs-grid {
        grid-template-columns: 1fr;
      }
      
      .job-details {
        width: 100%;
        right: -100%;
      }
      
      .pagination-container {
        flex-direction: column;
        gap: 15px;
        text-align: center;
      }
      
      .pagination-controls {
        justify-content: center;
        flex-wrap: wrap;
      }
      
      .pagination-pages {
        order: -1;
      }
    }
  </style>
</head>
<body>
  <div class="loading-spinner" id="loadingSpinner">
    <div class="spinner"></div>
  </div>

  <div class="toast-container" id="toastContainer"></div>

  <div class="main-container w-100">
    <!-- Sidebar -->
    <div class="sidebar">
      <div class="sidebar-header">
        <div class="logo">
          <img src="../assets/images/admin/admin-login-form-inverse.svg" alt="TruPath Logo">
        </div>
      </div>
      
      <ul class="nav-menu">
        <li class="nav-item">
          <a href="#" class="nav-link active">
            <div class="nav-icon" style="font-size: 25px;">‚äû</div>
            Jobs
          </a>
        </li>
      </ul>
      
      <a href="#" class="logout-link" onclick="logout()">
        <div class="nav-icon" style="font-size: 25px;">‚èª</div>
        Log out
      </a>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <div class="content-header">
        <div class="content-header-left">
          <h1 class="section-title m-0">All Jobs</h1>
        </div>
        <div class="content-header-right">
          <div class="search-container">
            <input type="text" class="search-input" placeholder="search by name" id="searchInput">
            <select class="jobs-per-page-select" id="jobsPerPageSelect">
              <option value="5">5 per page</option>
              <option value="10">10 per page</option>
              <option value="15" selected>15 per page</option>
              <option value="25">25 per page</option>
              <option value="50">50 per page</option>
              <option value="100">100 per page</option>
              <option value="infinite">Show All</option>
            </select>
            <button class="post-job-btn" onclick="showPostJobForm()">
              <img src="../assets/images/careers/postJob.svg" alt="Post Job" style="width: 16px; height: 16px;">
              Post A Job
            </button>
          </div>
        </div>
      </div>

      <div class="jobs-container">
        <div class="jobs-list">
          <div class="jobs-content">
            <div class="jobs-grid" id="allJobs">
              <!-- All Jobs will be loaded here -->
            </div>
            <div id="noJobsMessage" class="no-jobs-message" style="display: none;">
              <div class="no-jobs-content">
                <h3>No jobs found</h3>
                <p>There are no jobs matching your search criteria.</p>
              </div>
            </div>
          </div>
          
          <!-- Pagination - Always visible at bottom -->
          <div class="pagination-container" id="paginationContainer">
            <div class="pagination-info">
              <span id="paginationInfo">Showing 0 to 0 of 0 jobs</span>
            </div>
            <div class="pagination-controls">
              <button class="pagination-btn" id="prevBtn" onclick="changePage(-1)" disabled>
                <span>‚Üê</span> Previous
              </button>
              <div class="pagination-pages" id="paginationPages">
                <!-- Page numbers will be generated here -->
              </div>
              <button class="pagination-btn" id="nextBtn" onclick="changePage(1)" disabled>
                Next <span>‚Üí</span>
              </button>
            </div>
          </div>
        </div>

        <div class="job-details" id="jobDetailsPanel" style="display: none;">
        <div class="job-details-header">
          <h3 class="job-details-title">Job Details</h3>
          <div style="display: flex; align-items: center; gap: 10px;">
            <button onclick="closeJobDetails()" style="background: none; border: none; font-size: 20px; cursor: pointer; color: #666;">√ó</button>
          </div>
        </div>
          
          <form id="jobDetailsForm">
            <div class="form-group">
              <label class="form-label">Job Title *</label>
              <input type="text" class="form-input" id="jobTitle" placeholder="Enter job title" required>
            </div>
            
            <div class="form-group">
              <label class="form-label">Job Description *</label>
              <div id="jobDescriptionEditor" class="quill-editor"></div>
              <div id="jobDescriptionView" class="job-description-view" style="display: none;"></div>
            </div>
            
            
            <div class="form-group">
              <label class="form-label">Location *</label>
              <input type="text" class="form-input" id="location" placeholder="Enter job location" required>
            </div>
            
            <div class="form-group">
              <label class="form-label">Experience Level *</label>
              <input type="text" class="form-input" id="experienceLevel" placeholder="0 to 10 years" required>
            </div>
            
            <div class="form-group">
              <label class="form-label">Salary *</label>
              <input type="text" class="form-input" id="salary" placeholder="e.g., 25000/- per annum" required>
            </div>
            
            <div class="action-buttons">
              <button type="button" class="btn btn-primary" id="primaryActionBtn" onclick="handlePrimaryAction()">Update Changes</button>
              <button type="button" class="btn btn-danger" id="secondaryActionBtn" onclick="handleSecondaryAction()">Delete Job</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div class="modal" id="deleteModal">
    <div class="modal-content w-auto">
      <h3 class="modal-title">Are you sure you want to delete job?</h3>
      <div class="modal-actions">
        <button class="btn btn-danger d-flex align-items-center gap-2" onclick="confirmDelete()">
          <span class="nav-icon">üóëÔ∏è</span>
          <span>Delete Job</span>
        </button>
        <button class="btn btn-primary d-flex align-items-center gap-2" onclick="cancelDelete()">
          <span class="nav-icon">‚ùå</span>
          <span>Cancel</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Quill Editor JS -->
  <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
  
  <script>
    // Base URL
    const API_BASE_URL = 'http://localhost:3000';
    
    // Initialize Quill Editor
    let quillEditor;
    
    // Global variables
    let allJobs = [];
    let selectedJobId = null;
    let currentPage = 1;
    let totalPages = 1;
    let totalJobs = 0;
    let currentSearchTerm = '';
    let jobsPerPage = 15;

    // Initialize page
    document.addEventListener('DOMContentLoaded', function() {
      checkAuthentication();
      loadJobs();
      setupEventListeners();
      initializeQuillEditor();
    });

    // Check if user is authenticated
    function checkAuthentication() {
      const token = localStorage.getItem('authToken');
      
      if (!token) {
        showToast('Please login to access this page', 'error');
        setTimeout(() => {
          window.location.href = './login.html';
        }, 2000);
        return;
      }

      // For demo purposes, skip token verification
      loadJobs();
    }

    // Setup event listeners
    function setupEventListeners() {
      // Search functionality with debounce
      let searchTimeout;
      document.getElementById('searchInput').addEventListener('input', function(e) {
        const searchTerm = e.target.value.trim();
        
        // Clear previous timeout
        clearTimeout(searchTimeout);
        
        // Set new timeout
        searchTimeout = setTimeout(() => {
          currentSearchTerm = searchTerm;
          currentPage = 1; // Reset to first page when searching
          if (searchTerm.length === 0) {
            loadJobs(); // Load all jobs if search is empty
          } else {
            filterJobs(searchTerm);
          }
        }, 500); // 500ms delay
      });

      // Jobs per page selector
      document.getElementById('jobsPerPageSelect').addEventListener('change', function(e) {
        jobsPerPage = e.target.value === 'infinite' ? 999999 : parseInt(e.target.value);
        currentPage = 1; // Reset to first page when changing page size
        if (currentSearchTerm) {
          filterJobs(currentSearchTerm);
        } else {
          loadJobs();
        }
      });

      // Close dropdowns when clicking outside
      document.addEventListener('click', function(e) {
        if (!e.target.closest('.job-actions')) {
          closeAllDropdowns();
        }
        // Only close job details if clicking outside the panel and not on action buttons
        if (!e.target.closest('.job-details') && 
            !e.target.closest('.post-job-btn') && 
            !e.target.closest('.dropdown-item') &&
            !e.target.closest('.job-actions')) {
          closeJobDetails();
        }
      });
    }

    // Load jobs from API
    async function loadJobs() {
      try {
        showLoader(true);
        const response = await fetch(`${API_BASE_URL}/api/jobs?page=${currentPage}&limit=${jobsPerPage}`, {
          method: 'GET',
          headers: {
            'Content-Type': 'application/json'
          }
        });

        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }

        const result = await response.json();
        
        if (result.success) {
          allJobs = result.data;
          totalPages = result.pagination.pages;
          totalJobs = result.pagination.total;
          displayJobs(allJobs);
          updatePagination();
        } else {
          throw new Error(result.message || 'Failed to load jobs');
        }
      } catch (error) {
        console.error('Error loading jobs:', error);
        showToast('Failed to load jobs: ' + error.message, 'error');
        displayJobs([]);
      } finally {
        showLoader(false);
      }
    }

    // Display jobs in the UI
    function displayJobs(jobs) {
      const allJobsContainer = document.getElementById('allJobs');
      const noJobsMessage = document.getElementById('noJobsMessage');
      
      allJobsContainer.innerHTML = '';
      
      if (jobs.length === 0) {
        noJobsMessage.style.display = 'flex';
        return;
      }
      
      noJobsMessage.style.display = 'none';
      jobs.forEach(job => {
        const jobCard = createJobCard(job);
        allJobsContainer.appendChild(jobCard);
      });
    }

    // Create job card
    function createJobCard(job) {
      const jobCard = document.createElement('div');
      const firstLetter = job.title.charAt(0).toUpperCase();
      const iconClass = getIconClass(job.title);
      const formattedDate = job.formattedDate || formatDate(job.createdAt);
      
      jobCard.className = 'job-card';
      jobCard.innerHTML = `
        <div class="job-card-header">
          <div class="job-title">
            <div class="job-title-icon ${iconClass}">${firstLetter}</div>
            ${job.title}
          </div>
          <div class="job-actions" onclick="toggleDropdown('${job._id}')">
            <span>‚ãÆ</span>
            <div class="dropdown-menu" id="dropdown-${job._id}">
              <a href="#" class="dropdown-item" onclick="viewJob('${job._id}')">
                <span>üëÅÔ∏è</span>
                View
              </a>
              <a href="#" class="dropdown-item" onclick="editJob('${job._id}')">
                <span>üìù</span>
                Update
              </a>
              <a href="#" class="dropdown-item" onclick="deleteJob('${job._id}')">
                <span>üóëÔ∏è</span>
                Delete
              </a>
            </div>
          </div>
        </div>
        <div class="job-company">Join Our TPS Team!</div>
        <div class="job-location">
          <span>üìç</span>
          ${job.location}
        </div>
        <div class="job-meta">
          <div class="job-date">${formattedDate}</div>
        </div>
      `;
      return jobCard;
    }

    // Format date helper function
    function formatDate(dateString) {
      const date = new Date(dateString);
      const now = new Date();
      const diffTime = Math.abs(now - date);
      const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
      
      if (diffDays === 1) return '1 Day Ago';
      if (diffDays < 7) return `${diffDays} Days Ago`;
      if (diffDays < 30) return `${Math.ceil(diffDays / 7)} Weeks Ago`;
      return `${Math.ceil(diffDays / 30)} Months Ago`;
    }

    // Get icon class based on job title
    function getIconClass(title) {
      const lowerTitle = title.toLowerCase();
      if (lowerTitle.includes('hcc')) return 'hcc';
      if (lowerTitle.includes('ai')) return 'ai';
      if (lowerTitle.includes('drg')) return 'drg';
      return 'default';
    }

    // Toggle dropdown menu
    function toggleDropdown(jobId) {
      closeAllDropdowns();
      const dropdown = document.getElementById(`dropdown-${jobId}`);
      if (dropdown) {
        dropdown.style.display = 'block';
      }
    }

    // Close all dropdowns
    function closeAllDropdowns() {
      const dropdowns = document.querySelectorAll('.dropdown-menu');
      dropdowns.forEach(dropdown => {
        dropdown.style.display = 'none';
      });
    }

    // View job details
    async function viewJob(jobId) {
      event.preventDefault();
      try {
        showLoader(true);
        const response = await fetch(`${API_BASE_URL}/api/jobs/${jobId}`, {
          method: 'GET',
          headers: {
            'Content-Type': 'application/json'
          }
        });

        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }

        const result = await response.json();
        
        if (result.success) {
          selectedJobId = jobId;
          showJobDetails(result.data, true); // true indicates view mode
          closeAllDropdowns();
        } else {
          throw new Error(result.message || 'Failed to load job details');
        }
      } catch (error) {
        console.error('Error loading job details:', error);
        showToast('Failed to load job details: ' + error.message, 'error');
      } finally {
        showLoader(false);
      }
    }

    // Edit job
    async function editJob(jobId) {
      event.preventDefault();
      try {
        showLoader(true);
        const response = await fetch(`${API_BASE_URL}/api/jobs/${jobId}`, {
          method: 'GET',
          headers: {
            'Content-Type': 'application/json'
          }
        });

        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }

        const result = await response.json();
        
        if (result.success) {
          selectedJobId = jobId;
          showJobDetails(result.data, false); // false indicates edit mode
          closeAllDropdowns();
        } else {
          throw new Error(result.message || 'Failed to load job details');
        }
      } catch (error) {
        console.error('Error loading job details:', error);
        showToast('Failed to load job details: ' + error.message, 'error');
      } finally {
        showLoader(false);
      }
    }

    // Delete job
    function deleteJob(jobId) {
      event.preventDefault();
      selectedJobId = jobId;
      document.getElementById('deleteModal').style.display = 'block';
      closeAllDropdowns();
    }

    // Initialize Quill Editor
    function initializeQuillEditor() {
      quillEditor = new Quill('#jobDescriptionEditor', {
        theme: 'snow',
        modules: {
          toolbar: [
            [{ 'font': [] }, { 'size': ['small', false, 'large', 'huge'] }],
            ['bold', 'italic', 'underline'],
            ['blockquote', 'code-block'],
            [{ 'header': 1 }, { 'header': 2 }],
            [{ 'list': 'ordered'}, { 'list': 'bullet' }],
            ['link'],
            ['clean']
          ]
        }
      });
    }

    // Show job details panel
    function showJobDetails(job, isViewMode = false) {
      const jobDetailsPanel = document.getElementById('jobDetailsPanel');
      const form = document.getElementById('jobDetailsForm');
      
      // Populate form with job data
      document.getElementById('jobTitle').value = job.title || '';
      document.getElementById('salary').value = job.salary || '';
      document.getElementById('experienceLevel').value = job.experience || '';
      document.getElementById('location').value = job.location || '';
      
      // Set Quill editor content
      if (quillEditor) {
        const description = job.description || '';
        if (description) {
          // Check if description contains HTML tags
          if (description.includes('<') && description.includes('>')) {
            // It's HTML content, set it directly
            quillEditor.root.innerHTML = description;
          } else {
            // It's plain text, use setText
            quillEditor.setText(description);
          }
        } else {
          quillEditor.setText('');
        }
      }
      
      // Handle view vs edit mode
      if (isViewMode) {
        // View mode - show HTML content in view div and hide editor
        const descriptionView = document.getElementById('jobDescriptionView');
        const descriptionEditor = document.getElementById('jobDescriptionEditor');
        
        if (descriptionView && descriptionEditor) {
          descriptionView.innerHTML = job.description || '';
          descriptionView.style.display = 'block';
          descriptionEditor.style.display = 'none';
        }
        
        setFormMode(false);
        document.querySelector('.job-details-title').textContent = 'View Job Details';
      } else {
        // Edit mode - show editor and hide view div
        const descriptionView = document.getElementById('jobDescriptionView');
        const descriptionEditor = document.getElementById('jobDescriptionEditor');
        
        if (descriptionView && descriptionEditor) {
          descriptionView.style.display = 'none';
          descriptionEditor.style.display = 'block';
        }
        
        setFormMode(true);
        document.querySelector('.job-details-title').textContent = 'Edit Job Details';
      }
      
      // Force display and add show class
      jobDetailsPanel.style.display = 'block';
      jobDetailsPanel.style.right = '-400px'; // Start from hidden position
      
      // Use setTimeout to ensure the display change takes effect before animation
      setTimeout(() => {
        jobDetailsPanel.classList.add('show');
        jobDetailsPanel.style.right = '0'; // Animate to visible position
      }, 10);
    }

    // Close job details panel
    function closeJobDetails() {
      const jobDetailsPanel = document.getElementById('jobDetailsPanel');
      
      // Animate out first
      jobDetailsPanel.style.right = '-400px';
      jobDetailsPanel.classList.remove('show');
      
      // Hide after animation
      setTimeout(() => {
        jobDetailsPanel.style.display = 'none';
      }, 300);
    }

    // Set form mode (enabled/disabled)
    function setFormMode(enabled, mode = 'edit') {
      const form = document.getElementById('jobDetailsForm');
      const actionButtons = document.querySelector('.action-buttons');
      const primaryBtn = document.getElementById('primaryActionBtn');
      const secondaryBtn = document.getElementById('secondaryActionBtn');
      
      // Get all form inputs
      const inputs = form.querySelectorAll('input, select, textarea');
      
      inputs.forEach(input => {
        input.disabled = !enabled;
        if (!enabled) {
          input.style.backgroundColor = '#f5f5f5';
          input.style.cursor = 'not-allowed';
        } else {
          input.style.backgroundColor = '';
          input.style.cursor = '';
        }
      });
      
      // Disable/enable Quill editor
      if (quillEditor) {
        quillEditor.enable(enabled);
        const editorContainer = document.querySelector('.quill-editor');
        if (!enabled) {
          editorContainer.style.backgroundColor = '#f5f5f5';
          editorContainer.style.cursor = 'not-allowed';
        } else {
          editorContainer.style.backgroundColor = '';
          editorContainer.style.cursor = '';
        }
      }
      
      // Show/hide action buttons and set button text based on mode
      if (actionButtons) {
        actionButtons.style.display = enabled ? 'flex' : 'none';
        
        if (enabled && primaryBtn && secondaryBtn) {
          if (mode === 'post') {
            // Post new job mode
            primaryBtn.textContent = 'Post';
            primaryBtn.className = 'btn btn-primary';
            secondaryBtn.textContent = 'Cancel';
            secondaryBtn.className = 'btn btn-secondary';
          } else {
            // Edit existing job mode
            primaryBtn.textContent = 'Update Changes';
            primaryBtn.className = 'btn btn-primary';
            secondaryBtn.textContent = 'Cancel';
            secondaryBtn.className = 'btn btn-secondary';
          }
        }
      }
    }

    // Show post job form
    function showPostJobForm() {
      // Clear form and show job details panel
      const form = document.getElementById('jobDetailsForm');
      const jobDetailsPanel = document.getElementById('jobDetailsPanel');
      
      form.reset();
      
      // Clear Quill editor
      if (quillEditor) {
        quillEditor.setText('');
      }
      
      // Ensure editor is visible and view div is hidden for new job creation
      const descriptionView = document.getElementById('jobDescriptionView');
      const descriptionEditor = document.getElementById('jobDescriptionEditor');
      
      if (descriptionView && descriptionEditor) {
        descriptionView.style.display = 'none';
        descriptionEditor.style.display = 'block';
      }
      
      // Enable form for new job creation
      setFormMode(true, 'post');
      document.querySelector('.job-details-title').textContent = 'Post New Job';
      
      // Force display and add show class
      jobDetailsPanel.style.display = 'block';
      jobDetailsPanel.style.right = '-400px'; // Start from hidden position
      
      // Use setTimeout to ensure the display change takes effect before animation
      setTimeout(() => {
        jobDetailsPanel.classList.add('show');
        jobDetailsPanel.style.right = '0'; // Animate to visible position
      }, 10);
      
      selectedJobId = null;
    }

    // Handle primary action button (Post/Update)
    function handlePrimaryAction() {
      if (selectedJobId === null) {
        // Post new job mode
        postNewJob();
      } else {
        // Update existing job mode
        updateJob();
      }
    }

    // Handle secondary action button (Cancel)
    function handleSecondaryAction() {
      // Both post and edit modes - just cancel/close
      closeJobDetails();
    }

    // Post new job
    async function postNewJob() {
      // Validate form
      const jobTitle = document.getElementById('jobTitle').value.trim();
      const location = document.getElementById('location').value.trim();
      const experienceLevel = document.getElementById('experienceLevel').value.trim();
      const salary = document.getElementById('salary').value.trim();
      
      if (!jobTitle || !location || !experienceLevel || !salary) {
        showToast('Please fill in all required fields', 'error');
        return;
      }
      
      // Get Quill editor content as HTML
      const jobDescription = quillEditor ? quillEditor.root.innerHTML.trim() : '';
      
      if (!jobDescription) {
        showToast('Please enter a job description', 'error');
        return;
      }
      
      try {
        showLoader(true);
        
        const token = localStorage.getItem('authToken');
        if (!token) {
          throw new Error('Authentication token not found');
        }
        
        const response = await fetch(`${API_BASE_URL}/api/jobs`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${token}`
          },
          body: JSON.stringify({
            title: jobTitle,
            description: jobDescription,
            location: location,
            experience: experienceLevel,
            salary: salary
          })
        });

        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }

        const result = await response.json();
        
        if (result.success) {
          showToast('New job posted successfully!', 'success');
          closeJobDetails();
          loadJobs(); // Reload jobs list
        } else {
          throw new Error(result.message || 'Failed to create job');
        }
      } catch (error) {
        console.error('Error creating job:', error);
        showToast('Failed to create job: ' + error.message, 'error');
      } finally {
        showLoader(false);
      }
    }

    // Update job
    async function updateJob() {
      // Validate form
      const jobTitle = document.getElementById('jobTitle').value.trim();
      const location = document.getElementById('location').value.trim();
      const experienceLevel = document.getElementById('experienceLevel').value.trim();
      const salary = document.getElementById('salary').value.trim();
      
      if (!jobTitle || !location || !experienceLevel || !salary) {
        showToast('Please fill in all required fields', 'error');
        return;
      }
      
      // Get Quill editor content as HTML
      const jobDescription = quillEditor ? quillEditor.root.innerHTML.trim() : '';
      
      if (!jobDescription) {
        showToast('Please enter a job description', 'error');
        return;
      }
      
      try {
        showLoader(true);
        
        const token = localStorage.getItem('authToken');
        if (!token) {
          throw new Error('Authentication token not found');
        }
        
        const response = await fetch(`${API_BASE_URL}/api/jobs/${selectedJobId}`, {
          method: 'PUT',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${token}`
          },
          body: JSON.stringify({
            title: jobTitle,
            description: jobDescription,
            location: location,
            experience: experienceLevel,
            salary: salary
          })
        });

        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }

        const result = await response.json();
        
        if (result.success) {
          showToast('Job updated successfully!', 'success');
          closeJobDetails();
          loadJobs(); // Reload jobs list
        } else {
          throw new Error(result.message || 'Failed to update job');
        }
      } catch (error) {
        console.error('Error updating job:', error);
        showToast('Failed to update job: ' + error.message, 'error');
      } finally {
        showLoader(false);
      }
    }

    // Confirm delete
    async function confirmDelete() {
      if (selectedJobId) {
        try {
          showLoader(true);
          
          const token = localStorage.getItem('authToken');
          if (!token) {
            throw new Error('Authentication token not found');
          }
          
          const response = await fetch(`${API_BASE_URL}/api/jobs/${selectedJobId}`, {
            method: 'DELETE',
            headers: {
              'Content-Type': 'application/json',
              'Authorization': `Bearer ${token}`
            }
          });

          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }

          const result = await response.json();
          
          if (result.success) {
            showToast('Job deleted successfully!', 'success');
            loadJobs(); // Reload jobs
          } else {
            throw new Error(result.message || 'Failed to delete job');
          }
        } catch (error) {
          console.error('Error deleting job:', error);
          showToast('Failed to delete job: ' + error.message, 'error');
        } finally {
          showLoader(false);
        }
      }
      document.getElementById('deleteModal').style.display = 'none';
      document.getElementById('jobDetailsPanel').style.display = 'none';
      document.getElementById('jobDetailsPanel').classList.remove('show');
      selectedJobId = null;
    }

    // Cancel delete
    function cancelDelete() {
      document.getElementById('deleteModal').style.display = 'none';
      document.getElementById('jobDetailsPanel').style.display = 'none';
      document.getElementById('jobDetailsPanel').classList.remove('show');
      selectedJobId = null;
      showToast('Job deletion cancelled!', 'info');
    }

    // Filter jobs with API search
    async function filterJobs(searchTerm) {
      try {
        showLoader(true);
        
        const response = await fetch(`${API_BASE_URL}/api/jobs?search=${encodeURIComponent(searchTerm)}&page=${currentPage}&limit=${jobsPerPage}`, {
          method: 'GET',
          headers: {
            'Content-Type': 'application/json'
          }
        });

        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }

        const result = await response.json();
        
        if (result.success) {
          allJobs = result.data;
          totalPages = result.pagination.pages;
          totalJobs = result.pagination.total;
          displayJobs(result.data);
          updatePagination();
        } else {
          throw new Error(result.message || 'Failed to search jobs');
        }
      } catch (error) {
        console.error('Error searching jobs:', error);
        showToast('Failed to search jobs: ' + error.message, 'error');
        displayJobs([]);
      } finally {
        showLoader(false);
      }
    }

    // Logout function
    function logout() {
      localStorage.removeItem('authToken');
      showToast('Logged out successfully', 'success');
      setTimeout(() => {
        window.location.href = './login.html';
      }, 1000);
    }

    // Show/hide loader
    function showLoader(show) {
      const loader = document.getElementById('loadingSpinner');
      loader.style.display = show ? 'block' : 'none';
    }

    // Show toast notification
    function showToast(message, type = 'success') {
      const toastContainer = document.getElementById('toastContainer');
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      toast.textContent = message;
      
      toastContainer.appendChild(toast);
      
      // Show toast
      setTimeout(() => {
        toast.classList.add('show');
      }, 100);
      
      // Remove toast after 5 seconds
      setTimeout(() => {
        toast.classList.remove('show');
        setTimeout(() => {
          if (toastContainer.contains(toast)) {
            toastContainer.removeChild(toast);
          }
        }, 300);
      }, 5000);
    }

    // Update pagination UI
    function updatePagination() {
      const paginationContainer = document.getElementById('paginationContainer');
      const paginationInfo = document.getElementById('paginationInfo');
      const paginationPages = document.getElementById('paginationPages');
      const prevBtn = document.getElementById('prevBtn');
      const nextBtn = document.getElementById('nextBtn');

      // Always show pagination container
      paginationContainer.style.display = 'flex';

      // Update pagination info
      const startItem = (currentPage - 1) * jobsPerPage + 1;
      const endItem = Math.min(currentPage * jobsPerPage, totalJobs);
      paginationInfo.textContent = `Showing ${startItem} to ${endItem} of ${totalJobs} jobs`;

      // Update prev/next buttons
      prevBtn.disabled = currentPage === 1 || totalPages <= 1;
      nextBtn.disabled = currentPage === totalPages || totalPages <= 1;

      // Generate page numbers
      paginationPages.innerHTML = '';
      
      if (totalPages <= 1) {
        // Show just the current page when there's only one page
        const pageBtn = document.createElement('button');
        pageBtn.className = 'page-number active';
        pageBtn.textContent = '1';
        pageBtn.disabled = true;
        paginationPages.appendChild(pageBtn);
      } else {
        const maxVisiblePages = 5;
        let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
        let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);
        
        if (endPage - startPage + 1 < maxVisiblePages) {
          startPage = Math.max(1, endPage - maxVisiblePages + 1);
        }

        for (let i = startPage; i <= endPage; i++) {
          const pageBtn = document.createElement('button');
          pageBtn.className = `page-number ${i === currentPage ? 'active' : ''}`;
          pageBtn.textContent = i;
          pageBtn.onclick = () => goToPage(i);
          paginationPages.appendChild(pageBtn);
        }
      }
    }

    // Change page
    function changePage(direction) {
      const newPage = currentPage + direction;
      if (newPage >= 1 && newPage <= totalPages) {
        goToPage(newPage);
      }
    }

    // Go to specific page
    function goToPage(page) {
      currentPage = page;
      if (currentSearchTerm) {
        filterJobs(currentSearchTerm);
      } else {
        loadJobs();
      }
    }

    // Test function to add sample jobs (for testing pagination)
    async function addTestJobs() {
      const testJobs = [
        { title: "Software Engineer", description: "Full-stack development", location: "Mumbai", experience: "2-5 years", salary: "8-12 LPA" },
        { title: "Data Analyst", description: "Data analysis and reporting", location: "Delhi", experience: "1-3 years", salary: "5-8 LPA" },
        { title: "UX Designer", description: "User experience design", location: "Bangalore", experience: "2-4 years", salary: "6-10 LPA" },
        { title: "DevOps Engineer", description: "Infrastructure and deployment", location: "Pune", experience: "3-6 years", salary: "10-15 LPA" },
        { title: "Product Manager", description: "Product strategy and management", location: "Hyderabad", experience: "4-7 years", salary: "12-18 LPA" },
        { title: "QA Engineer", description: "Quality assurance testing", location: "Chennai", experience: "1-4 years", salary: "4-8 LPA" },
        { title: "Frontend Developer", description: "React and JavaScript development", location: "Gurgaon", experience: "2-5 years", salary: "6-12 LPA" },
        { title: "Backend Developer", description: "Node.js and database development", location: "Kolkata", experience: "2-5 years", salary: "6-12 LPA" },
        { title: "Mobile Developer", description: "iOS and Android development", location: "Ahmedabad", experience: "2-4 years", salary: "5-10 LPA" },
        { title: "Cloud Architect", description: "AWS and cloud infrastructure", location: "Noida", experience: "5-8 years", salary: "15-25 LPA" },
        { title: "AI/ML Engineer", description: "Machine learning and AI development", location: "Mumbai", experience: "3-6 years", salary: "10-20 LPA" },
        { title: "Cybersecurity Analyst", description: "Security analysis and monitoring", location: "Delhi", experience: "2-5 years", salary: "8-15 LPA" },
        { title: "Database Administrator", description: "Database management and optimization", location: "Bangalore", experience: "3-7 years", salary: "8-16 LPA" },
        { title: "Technical Writer", description: "Technical documentation", location: "Pune", experience: "1-3 years", salary: "4-7 LPA" },
        { title: "Sales Engineer", description: "Technical sales and support", location: "Hyderabad", experience: "2-5 years", salary: "6-12 LPA" }
      ];

      const token = localStorage.getItem('authToken');
      if (!token) {
        showToast('Please login first', 'error');
        return;
      }

      try {
        showLoader(true);
        let successCount = 0;
        
        for (const job of testJobs) {
          try {
            const response = await fetch(`${API_BASE_URL}/api/jobs`, {
              method: 'POST',
              headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${token}`
              },
              body: JSON.stringify(job)
            });
            
            if (response.ok) {
              successCount++;
            }
          } catch (error) {
            console.error('Error creating job:', error);
          }
        }
        
        showToast(`Created ${successCount} test jobs successfully!`, 'success');
        loadJobs(); // Reload to show pagination
      } catch (error) {
        console.error('Error adding test jobs:', error);
        showToast('Failed to add test jobs', 'error');
      } finally {
        showLoader(false);
      }
    }

    // Add test button to console for easy access
    window.addTestJobs = addTestJobs;
  </script>
</body>
</html>
